Программа предназначена для расчета оптических спектров слоистых наноструктур методом матриц переноса.


# Импорт внешних данных

* оптические спектры
* дисперсии диэлектрической проницаемости и показателя преломления

Это можно сделать через пункты меню `File -> Import`.

### Требования к формату данных для импорта

* импорт данных осуществляется из файлов формата `txt` или `dat`
* данные должны быть представлены в табличном формате (обычно это столбец значений `X` и столбец значений `Y`; названия столбцов игнорируются)

### Допускается импорт из файла с тремя столбцами

* первый столбец будет интерпретирован как `X`
* второй столбец будет интерпретирован как `re(Y)`
* третий столбец будет интерпретирован как `im(Y)`

# Экспорт расчета
* экспорт текущего расчета в файл (например, спектра отражения или спектра комплексного показателя преломления): `File -> Export`
* множественный экспорт (в диапазоне углов падения света или в диапазоне температур): `File -> Multiple Export`

# Работа с графиками

* выделение мышью области полотна с графиками позволяет изменить масштаб и зуммировать данный фрагмент
* выделение мышью диапазона на оси `X` или `Y` позволяет изменить масштаб в рамках выделенного диапазона по соответствующей оси
* двойной клик по области с графиками позволяет вернуться к исходному масштабу
* нажатие с удержанием правой кнопки мыши и перемещение мыши позволяют визуально "смещать" поле с графиками
* график можно выделить путем клика мышью по соответствующей легенде. После чего в панели `Graph Manager` появляется возможность редактировать имя, цвет, скрывать/показывать график, а также масштабировать его по осям (например, масштабирование по оси `Y` оказывается удобным для точной "подстройки" уровня нерезонансного отражения)

_NB: изменять имя и масштабировать по осям можно только импортированные данные_

# Типы расчетов

* оптическое отражение, `R`
* оптическое пропускание, `T`
* оптическое поглощение, `A = 1 - R - T`
* для структуры c ровно одним слоем
* комплексный показатель преломления, `n`
* диэлектрическая проницаемость, `eps = n^2`
* коэффициент экстинкции света по теории Ми, `alphaExt`
* коэффициент рассеяния света по теории Ми, `alphaSca`

# Формат описания наноструктуры

* конфигурация наноструктуры описывается перечислением слоев материалов, ее составляющих
* описания слоёв группируются в блоки. Каждый блок предваряется строкой вида: `xN` (для первого блока это необязательно), где `N >= 1` - количество повторений блока. Например, `x5` означает, что следующие несколько слоев (до следующего дескриптора повторения блока) будут повторяться 5 раз. Это удобно для описания периодических структур, например, последовательностей пар квантовых ям и барьеров
* описание каждого слоя начинается с ключевого слова `type` или `material`, после которого должен быть указан известный тип слоя
* ключевое слово `material` отвечает описанию слоя из определенного материала, заранее известного (см. ниже) или определенного пользователем
* ключевое слово `type` отвечает описанию сложного композиционного слоя (например, среда с экситонным возбуждением или системой наночастиц), заранее известного (см. ниже) или определнного пользователем
* далее в произвольном порядке следует список параметров слоя (например, толщина, способ расчета показателя преломления света и т.д.)
* описание параметров слоя можно распределить на несколько строк. Заканчивается описание слоя символом `;`


#### Пример описания структуры с 30 КЯ GaAs толщиной 10 нм с экситонным состоянием с резонансной энергией 1.63 эВ

```
material: GaAs, eps: adachi_simple, d: 90, df: 0.0;
material: AlGaAs, eps: adachi_simple, d: 110, df: 0.0, cAl: 0.35;

x30
type: excitonic,
medium: { material: GaAs, eps: adachi_gauss, df: 0.0 },
exciton: { w0: 1.63, G0: 0.0005, G: 0.01, wb: 3.205, Gb: 0.027, B: 1000000, C: (0, 0) },
d: 10;
material: AlGaAs, eps: adachi_simple, d: 100, df: 0.0, cAl: 0.35;

// this is a single-line comment
/*
    this is a multi-line comment
*/
```


# Поддерживаемые типы слоев с примерами синтаксиса
#### 1. Слой GaAs

```
material: GaAs, eps: adachi_simple, df: 0.1, d: 5;
```

* `eps` - диэлектрическая проницаемость.  Допустимые модели `eps` для слоев на основе GaAs (детальное описание см. далее в разделе "Оптические модели для полупроводников")
    * `adachi_simple`
    * `adachi_T`
    * `adachi_gauss`
    * `adachi_mod_gauss`
    * `tanguy_95`
    * `tanguy_99`
    * `adachi_simple_tanguy_95`
* `df` - числовой коэффициент для вычисления `im(eps)` по формуле `im(eps) = re(eps) * df` _df означает damping factor_. Работает, когда указаны модели `adachi_simple` или `adachi_mod_gauss`, иначе игнорируется
* `d` - толщина слоя `[нм]`

#### 2. Слой AlGaAs
```
material: AlGaAs, eps: adachi_simple, d: 5, df: 0.0, cAl: 0.3;
```
* `cAl` - концентрация `Al` в диапазоне от `0` до `1`

#### 3. Слой AlGaAsSb
```
material: AlGaAsSb, d: 5, cAl: 0.3, cAs: 0.02;
```
* `cAs` - концентрация `As` в диапазоне от `0` до `1`
  _NB: единственный способ рассчитать `eps` для данного слоя - с помощью модели [2], поэтому `eps` в параметрах не указывается_

#### 4. Слой GaN
модель для расчета диэлектрической проницаемости взята из [4]
```
material: GaN, d: 5
```

#### 5. Слой AlGaN
модель для расчета диэлектрической проницаемости взята из [4]
```
material: AlGaN, d: 5, cAl: 0.3;
```

#### 6. Слой материала с заданным показателем преломления
```
material: custom, d: 90, eps: (см. ниже);
```
`eps` - диэлектрическая проницаемость, задаваемая вещественным/комплексным числом, вычислимым выражением или известной дисперсией импортированной извне
```
eps: 12.5 // вещественное число
eps: (12.5, 0.3) // комплексное число, re(eps) = 12.5, im(eps) = 0.3

// вычислимое вещественное выражение
eps: {
   val v = Pi * 0.05
   fun f(a, b) = sin(a * b) * 0.5
   return f(x, v) // вещественное число, равное значению функции f(x, v)
}

// вычислимое комплексное выражение
eps: {
   val v = Pi * 0.05
   fun f(a, b) = sin(a * b) * 0.5
   fun g(a) = cos(a * 0.1) * 0.5
   return (f(x, v), g(x)) // комплексное число C: re(C) = f(x, v), im(C) = g(x)
}

eps: custom_eps_dispersion_name // диэлектрическая проницаемость задается именем файла с внешней дисперсией (расширение файла использовать не надо)
```
В примере с вычислимым выражением `val` - объявление переменной, `fun` - объявление функции, `v` - объявленная ранее переменная, `x` - текущее значение длины волны (энергии), `return` обозначает выражение, которое следует вычислить.
_NB: детальный справочник по доступным функциям см. в отдельной вкладке `Expressions Help`_

#### 7. Слой материала с экситонным возбуждением
```
type: excitonic,
medium: { material: GaAs, eps: adachi_simple, df: 0.0 },
exciton: { w0: 1.5, G0: 0.0005, G: 0.1, wb: 1.5, Gb: 0.0002, B: 1, C: 1 },
d: 12;
```
* `medium` - описание материала среды (см. пункты выше 1 - 4)
* `exciton` - описание экситонного состояния
    * `w0` - резонансная частота экситона `[эВ]`
    * `G0` и `G` - радиационное и нерадиационное экситонные уширения `[эВ]`
      // следующие параметры взяты из статьи [5] `eq. 9`
    * `wb` - разность энергий дна зоны проводимости и вершины валентной зоны `wb = w0 + E_ex`, где `E_ex` - энергия связи экситона (2D: `9 мэВ` в `GaAs` или `25 мэВ` в `GaN`, 3D: `4 мэВ` в `GaAs`)
    * `Gb` - параметр уширения для межзонных оптических переходов в КЯ (`Gb` примерно равняется `G`)
    * `B` - амплитудный параметр, равный `f_exc / (N_cv * f_b)`, который определяет отношение сил осциллятора экситона и переходов в непрерывном спектре. Теоретически он должен составлять от `2Ry` (3D) до `16Ry` (2D) экситонных ридбергов
    * `C` - комплексный аддитивный параметр, дополняющий экситонный вклад в диэлектрическую проницаемость `eps_QW = eps_medium * (1 + excitonic_contribution + C)`

#### 8. Слой композитного материала в модели эффективной среды
```
type: eff_medium,
medium: { material: AlGaAs, eps: adachi_simple, df: 0.0, cAl: 0.3 },
particles: (см. ниже),
d: 1000, f: 0.01;
```
* `f` - объемная доля наночастиц
* `particles` - описание сферической наночастицы (см. варианты описания ниже)
```                
particles: { material: Drude, w: 14.6, G: 0.5, eps_inf: 1.0 }
```
* `type` - тип наночастиц, диэлектрическая проницаемость которых вычисляется по теории Друде
* `w` - частота плазмонного резонанса (ПР) в вакууме `[эВ]`
* `G` - полная ширина пика ПР на половине высоты `[эВ]`
* `eps_inf` - высокочастотная диэлектрическая проницаемость

```
particles: {
   material: Drude_Lorentz, w: 14.6, G: 0.5, eps_inf: 1.0,
   oscillators: {
   1: { w: 1, f: 2, g: 3 },
   2: { w: 4, f: 5, g: 6 }
   }
}
```
* `material` - материал наночастиц, диэлектрическая проницаемость которых вычисляется в модели Друде-Лоренца [6]
* `oscillators` - описание набора лоренцевых осцилляторов в формате `i: { w: value, f: value, g: value }`
    * `i` - номер осциллятора
    * `w` - резонансная частота осциллятора `[эВ]`
    * `f` - амплитудный параметр
    * `g` - параметр уширения `[эВ]`

```
particles: { material: custom, eps: (см. ниже) }
```
* `material` - см. п. 6
```
particles: { material: (одно из значений ниже) }
```
* `Sb_Cardona`, объемная сурьма, экспериментальные данные из [7]
* `Sb_Pallik`, объемная сурьма, экспериментальные данные из [8]
* `Bi_Cardona_Adachi_orthogonal`, объемный висмут, экспериментальные данные из [7]
* `Bi_Cardona_Adachi_parallel`, объемный висмут, экспериментальные данные из [7]
* `Bi_Werner_experiment`, объемный висмут, экспериментальные данные из [9]
* `Bi_Werner_DFT_calculations`, объемный висмут, DFT расчеты из [9]


#### 9. Слой, представляющий квадратную решетку сферических частиц, оптические свойства которой рассчитываются в модели [10]
```
type: spheres_lattice,
medium: { material: AlGaAs, eps: adachi_simple, df: 0.0, cAl: 0.3 },
particles: { material: Drude, w: 14.6, G: 0.5, eps_inf: 1.0 },
d: 40, lattice_factor: 8.1;
```
* `lattice_factor` - масштабирующий коэффициент, равный отношению постоянной квадратной решетки сферических частиц к их радиусу (радиус частиц полагается равным `d / 2`)


#### 10. Слой композитного материала для расчета дисперсии коэффициентов экстинкции и поглощения света по теории Ми
Допустимые режимы расчета: `Extinction Coefficient`, `Scattering Coefficient`.
**ВАЖНО:** в `particles` необходимо указывать радиус частиц, в отличие от, например, модели эффективной среды.
```
type: mie,
orders: all,
f: 0.01,
d: 0,
medium: { material: AlGaAs, eps: adachi_simple, df: 0.0, cAl: 0.3 },
particles: { material: Drude, r: 10.6, w: 14.6, G: 0.5, eps_inf: 1.0 },
include_medium_absorption: true;
```
* `orders` - учитываемые порядки разложения ряда рассеяния. Допустимые значения: `1`, `2`, `all`
* `particles` - описание сферической наночастицы
    * `r` - радиус частицы `[нм]`
* `include_medium_absorption` - флаг, учитывать ли поглощение внешней матрицы (значения: `true` или `false`) 


# Определение пользовательских материалов и типов

Данная функция предназначена для удобства переиспользования одних и тех же материалов/типов в описании структуры, слои которых отличаются, например, только толщиной. Для этого необходимо составить определение (`def`) оптического материала/типа с указанием пользовательского имени и описанием материала/типа (как при работе с обычным слоем) за исключением толщины.

_NB: определения пользовательских материалов/типов должны быть приведены в самом начале описания структуры до перечисления слоев_

#### Определение пользовательских материалов

```
def: {
    name: custom_GaN,

    material: custom,
    eps: {
        fun f(q)=5.1529+(92842.09/(q*q-86436))
        return (f(x), 0)
    }
};
```
* `name` - имя пользовательского материала, которое необходимо задать вручную

#### Определение пользовательских типов

```
def: {
    name: custom_InGaN_QW,

    type: excitonic,
    medium: { material: custom, eps: (6.7599, 0) },
    exciton: { w0: 3.18, G0: 0.00025, G: 0.04, wb: 3.205, Gb: 0.027, B: 1000000, C: (0, 0) }
};
```

#### Рабочий пример описания структуры
```
def: {
    name: custom_GaN,

    material: custom,
    eps: {
        fun f(q)=5.1529+(92842.09/(q*q-86436))
        return (f(x), 0)
    }
};

def: {
    name: custom_InGaN_QW,

    type: excitonic,
    medium: { material: custom, eps: (6.7599, 0) },
    exciton: { w0: 3.18, G0: 0.00025, G: 0.04, wb: 3.205, Gb: 0.027, B: 1000000, C: (0, 0) }
};

material: custom_GaN, d: 87.2; // использование выше определенного материала

x10
type: custom_InGaN_QW, d: 2.2;
material: custom_GaN, d: 74.5;
```

# Оптические модели для полупроводников
Различные модели требуют дополнительные параметры, которые должны быть заданы после указания имени модели в описании стуктуры. Требумые параметры приведены для каждой модели ниже:

* `adachi_simple` - простая модель Адачи [1]
    * `cAl` - концентрация `Al` в диапазоне от `0` до `1`
* `adachi_T` - расширенная модель Адачи для четверного сплава `Al(x)Ga(1-x)As(y)Sb(1-y)`, учитывающая зависимость оптических свойств компонент раствора от температуры [2]
    * `cAl` - концентрация `Al` в диапазоне от `0` до `1`
    * `cAs` - концентрация `As` в диапазоне от `0` до `1`
* `adachi_gauss` - модифицированная модель Адачи из [1] (без температурной зависимости), в которой параметры уширения оптических переходов описываются при помощи гауссианов [3]
    * `cAl` - концентрация `Al` в диапазоне от `0` до `1`
    * `G` - параметр экситонного уширения
* `adachi_mod_gauss` - модифицированная модель из п. c), в которой мнимая компонента показателя преломления `im(eps)` при энергиях ниже края фундаментального поглощения рассчитывается по формуле `re(eps) * df`
    * `cAl` - концентрация `Al` в диапазоне от `0` до `1`
    * `G` - параметр экситонного уширения
    * `df` - числовой коэффициент для вычисления `im(eps)` по формуле `im(eps) = re(eps) * df`
* `tanguy_95_general` - общая модель, учитывающая дисперсию Ванье-экситонов [11]
    * `G` - нерадиационное экситонное уширение `[эВ]`
    * `m_e` - масса электрона `[кг]`
    * `m_hh` - масса тяжелой дырки `[кг]`
    * `Eg` - ширина запрещенной зоны `[эВ]`
    * `exciton_rydberg` - энергия связи экситона [эВ]`
    * `matr_el` - матричный элемент (см. `eq (2)` в работе [11])
    * `eps_infra` - фоновая диэлектрическая проницаемость (ее величина может быть не постоянной)
* `tanguy_95` - модель `tanguy_95_general` для `AlGaAs` c подогнанными `eps_infra` и `matr_el` в зависимости от `cAl`.
    * `cAl` - концентрация `Al` в диапазоне от `0` до `1`
    * `G` - параметр экситонного уширения
* `tanguy_99` - модель для AlGaAs, модификация `tanguy_95` с учетом Hulthen-потенциала [12]
    * `cAl` - концентрация `Al` в диапазоне от `0` до `1`
    * `G` - параметр экситонного уширения
    * `g_param` - параметр потенциала (см. `eq. (1)` в [12])
    * `matr_el` - матричный элемент (см. `eq (2)` в работе [11])
    * `eps_infra` - фоновая диэлектрическая проницаемость (ее величина может быть не постоянной)
* `adachi_simple_tanguy_95` - гибридная модель, в которой вещественная часть `eps` считается по модели `adachi_simple`, а мнимая -- по модели `tanguy_95`
    * `cAl` - концентрация `Al` в диапазоне от `0` до `1`
    * `G` - параметр экситонного уширения

#### Пример описания структуры с моделью `tanguy_95_general`
```
material: custom,
eps: tanguy_95_general,

G: 0.028,

m_e: 1.0275E-31,
m_hh: 6.0122E-31,
Eg: 2.2512,
exciton_rydberg: 0.0108,
matr_el: 2.28E-19,
eps_infra: 4.2,

d: 1000
```

# Импорт внешней дисперсии диэлектрической проницаемости или показателя преломления
Меню:
`File -> Import -> Permittivity Dispersion`
`File -> Import -> Refractive Index Dispersion`

Данная функция предназначена для расширения базовой функциональности приложения путем добавления новых оптических характеристик пользовательских материалов. Дисперсия может быть вещественной (файл с двумя столбцами) или комплексной (файл с тремя столбцами). Тип импорта дисперсии (диэлектрической проницаемости или показателя преломления) определяется в соответствующем меню импорта. Использование новой дисперсии осуществляется в рамках описания материала типа `custom` в поле для `eps` (см. пример ниже). При этом в качестве имени дисперсии в описании будет использоваться имя импортируемого файла (для удобства работы с приложением не используйте длинные имена файлов).

_NB: на данный момент доступна возможность импорта внешней дисперсии только для материала среды, для частиц - TODO_.

#### Пример: импорт дисперсии диэлектрической проницаемости из файла GaAsRII.txt
```
type: excitonic,
medium: { material: custom, eps: GaAsRII, df: 0 },
exciton: { w0: 1.7, G0: 0.0005, G: 0.01, wb: 3.205, Gb: 0.027, B: 1000000, C: (0, 0) },
d: 10;
```

При импорте внешней дисперсии показателя преломления в описании структуры также необходимо указывать ее имя после поля `eps`, опуская расширение файла. Приложение будет учитывать, что импортированная дисперсия соответствует диэлектрической проницаемости. Повторный импорт дисперсии из файла с таким же именем стрирает информацию о предыдущем импорте (в частности о типе дисперсии). Например, при повторном импорте файла `GaAsRII.txt`, как дисперсии показателя преломления, программа забудет о том, что раньше эта дисперсия рассматривалась, как дисперсия диэлектрической проницаемости.

Управление импортированными дисперсиями осуществляется с помощью менеджера внешних дисперсий, который можно вызывать через меню `Tools -> External Dispersions...`. В этом окне отображается весь список импортированных дисперсий. Для удаления дисперсии необходимо выделить ее и надать кнопку `remove`.

# Рандомизация вычислений

Рандомизация вычислений (РВ) предназначена для автоматизированного многоповторного прогона однотипных вычислений спектров, в которых указанные параметры описания структуры меняются в некотором диапазоне значений в соответствии с нормальным распределением (https://en.wikipedia.org/wiki/Normal_distribution). Итоговый результат вычисляется путем усреднения по всем промежуточным расчетам.

Открыть окно РВ можно через пункты меню `Tools -> Randomization...`

В левой части окна располагается описание структуры, в котором необходимо указать параметры, которые могут меняться от расчета к расчету (на данный момент варьируемыми могут быть только параметры, представленные вещественными числами). Для этого используется специальный синтаксис:
```
var(mean_value, standard_deviation)
```
* `mean_value` - среднее значение параметра
* `standard_deviation` - стандартное отклонение (сигма)

#### Пример описания структуры с варьируемыми параметрами
```
x1
material: GaAs, eps: adachi_simple, d: var(10, 0.1), df: 0;
material: AlGaAs, eps: adachi_simple, cAl: var(0.3, 0.05), d: 100, df: 0;
``` 

_NB: в описании структуры в окне РВ должен быть указан хотя бы один варьируемый параметр_.

В правой части окна РВ указаны параметры множественных расчетов:
* `Iterations` - количество повторений расчета
* `Parallelism` - степень параллелизма (рекомендуется устанавливать значение, не превышающее число ядер CPU)
* `Save intermediate results` - TODO
* `Run` - кнопка запуска вычислений
* `Stop` - кнопка прерывания вычислений

В правой нижней части окна располагается шкала прогресса. По окончании вычислений пользователю будет предложено выбрать место, куда следует сохранить усредненный результат.

# Множественные вычисления

Множественные вычисления (МВ) предназначены для автоматизированного вычисления спектров, в которых указанные вещественные параметры описания структуры меняются в определенном диапазоне в соответствии с заданными значениями `start`, `end` и `step`. Для каждого такого расчета создается соответствующий файл.

Открыть окно МВ можно через пункты меню `Tools -> Multiple computations...`

В левой части окна располагается описание структуры, в котором необходимо указать один параметр, которые может принимать значение из конкретного диапазона (на данный момент варьируемыми могут быть только параметры, представленные вещественными числами). Для этого используется специальный синтаксис:
```
range(start, end, step)
```
* `start` - начальное значение параметра
* `end` - конечное значение параметра
* `step` - шаг

#### Пример описания структуры с инкрементируемыми параметрами
```
x1
material: GaAs, eps: adachi_simple, d: 10, df: 0;
material: AlGaAs, eps: adachi_simple, cAl: range(0.3, 0.6, 0.05), d: 100, df: 0;
```

_NB: в описании структуры в окне МВ должен быть только один варьируемый параметр_.

Перед началом вычислений необходимо выбрать папку, в которую будут сохраняться файлы с результатами.


# Ссылки

1.  GaAs, AlAs, and AlxGa1−xAs: Material parameters for use in research and device applications. J. Appl. Phys., 58, R1 (1985); https://doi.org/10.1063/1.336070, Sadao Adachi

2. Calculations of the temperature and alloy composition effects on the optical properties of AlxGa1−xAsySb1−y and GaxIn1−xAsySb1−y in the spectral range 0.5–6 eV, J. Appl. Phys., 102, 014504 (2007); https://doi.org/10.1063/1.2751406, Juan A. Gonzalez-Cuevas

3. Modeling the optical constants of AlxGa1−xAs alloys. J. Appl. Phys., 86, pp.445 (1999). http://dx.doi.org/10.1063/1.370750. A.B. Djurisˇic, A.D. Rakic, P.C.K. Kwok, E. Herbert Li, M.L. Majewski, J.M. Elazar

4. Dependence of the refractive index of AlxGa1-xN on temperature and composition at elevated temperatures. J. Appl. Phys., 89, 5, pp.2676 (2000). https://doi.org/10.1063/1.1341212. U. Tisch, B. Meyler, O. Katz, E. Finkman, J. Salzman

5. Room temperature exciton-polariton resonant reflection and suppressed absorption in periodic systems of InGaN quantum wells. Journal of Applied Physics 121, 133101 (2017). https://doi.org/10.1063/1.4979636 (eq. 6). A.S. Bolshakov, V.V. Chaldyshev

6. Klimov "Nanoplasmonica" - russian edition, eq. 3.44

7. Adachi, S. The Handbook on Optical Constants of Metals in Tables and Figures / S. Adachi – World Scientific, 2012

8. Pallik, E.D. Handbook of Optical Constants of Solids Volume 2 / E.D. Pallik // ISBN: 978-0-12-544422-4

9. W. S. M. Werner, K. Glantschnig, C. Ambrosch-Draxl. Optical constants and inelastic electron-scattering data for 17 elemental metals, J. Phys Chem Ref. Data 38, 1013-1092 (2009)

10. Optical properties of two-dimensional systems of randomly distributed particles. Phys. Rev. B 28, 4247 – Published 15 October 1983. https://doi.org/10.1103/PhysRevB.28.4247. B. N. J. Persson and A. Liebsch

11. Optical Dispersion by Wannier Excitons. Phys. Rev. Lett. 75, 4090 (1995). https://doi.org/10.1103/PhysRevLett.75.4090. C. Tanguy

12. Analytical expression of the complex dielectric function for the Hulthén potential. Phys. Rev. B 60, 10660, 1999. https://doi.org/10.1103/PhysRevB.60.10660. C. Tanguy
